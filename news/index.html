<!DOCTYPE html>
<html lang="zh-cn">
<head prefix="og: http://ogp.me/ns#">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <title>News | YXZ's Blog</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://yaoxuanzhi.github.io/news/index.html">
  <!-- Alternative links -->
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <meta name="generator" content="Hexo 3.8.0">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="YXZ's Blog">
  <!-- Open Graph -->
  <meta property="og:type" content="website">
<meta property="og:title" content="News">
<meta property="og:url" content="https://yaoxuanzhi.github.io/news/index.html">
<meta property="og:site_name" content="YXZ&#39;s Blog">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="News">
  <!-- Google Analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  
</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/" id="logo">YXZ's Blog</a>
    </h1>
    <nav id="main-nav">
      <a href="/news/" class="main-nav-link">随笔</a><a href="/dev/" class="main-nav-link">开发</a><a href="/open_source/" class="main-nav-link">开源</a><a href="/tool/" class="main-nav-link">工具</a><a href="/about/" class="main-nav-link">关于我</a>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></label>
      <select id="lang-select" data-canonical="">
        
          <option value="zh-cn" selected>简体中文</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    
<div id="content-wrap">
  <div class="wrapper">
    <div class="inner">
      
        
          <article class="article post" itemscope itemtype="http://schema.org/Article">
  <header class="article-header">
    
      <h1>
        <a href="/news/2021/06/12/improve-msys2/" class="article-title" itemprop="name">改造msys2</a>
      </h1>
    
    <a href="/news/2021/06/12/improve-msys2/" class="article-date"><time datetime="2021-06-12T00:00:00.000Z">2021-06-12</time></a>
  </header>
  <div class="article-content" itemprop="articleBody">
    <h2 id="前言" class="article-heading"><a href="#前言" class="headerlink" title="前言"></a>前言<a class="article-anchor" href="#前言" aria-hidden="true"></a></h2><p>由于新工作的开发需要，其服务器工程在windows下需要借助msys2上的gcc环境来进行编译并运行，因此，日常开发工作中，需要经常打开msys2终端来输入各种shell指令</p>
<p>但本人更加偏好有个集成的dos脚本，在上面输入【1】【2】【3】等数字之后，就能执行相应的【构建】【启动】【测试】等命令，并且直接调用msys2上的类linux环境来执行这些命令</p>
<p>本着 <strong>自己动手 丰衣足食</strong> 的打算，已经将这个集成脚本完成了，本篇文章是其副产物</p>
<h2 id="为msys2的追加镜像源" class="article-heading"><a href="#为msys2的追加镜像源" class="headerlink" title="为msys2的追加镜像源"></a>为msys2的追加镜像源<a class="article-anchor" href="#为msys2的追加镜像源" aria-hidden="true"></a></h2><p>基于 <a href="https://mirrors.tuna.tsinghua.edu.cn/help/msys2/" target="_blank" rel="noopener">《MSYS2 镜像使用帮助》</a>提供的实现思路，最初使用Python来快速实现了一个脚本</p>
<details><br>  <summary>append_extra_mirror_source.py</summary><br><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># !/user/bin/env python</span><br><span class="hljs-comment"># -*- coding:utf-8 -*- </span><br><span class="hljs-keyword">import</span> os, glob, codecs, re, argparse<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_mirror_url</span><span class="hljs-params">(mirror_url)</span>:</span><br>    mirror_paths = glob.glob(<span class="hljs-string">"mirrorlist*"</span>)<br><br>    re_pattern = <span class="hljs-string">r'(Server = )(https.*.org)(.*)'</span><br><br>    <span class="hljs-keyword">for</span> path <span class="hljs-keyword">in</span> mirror_paths:<br>        <span class="hljs-keyword">with</span> codecs.open(path, mode=<span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"utf-8"</span>, errors=<span class="hljs-string">'ignore'</span>) <span class="hljs-keyword">as</span> f:<br>            config = f.read()<br>            f.close()<br>            search_re = re.search(re_pattern, config, re.M|re.I)<br>            exist_same_re = re.search(mirror_url, config, re.M|re.I)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> exist_same_re <span class="hljs-keyword">and</span> search_re:<br>                mirror_url_item = search_re.group()<br>                temp = re.compile(re_pattern)<br>                mirror_url_item = temp.sub(<span class="hljs-string">r'\1%(mirror_url)s\3'</span> % &#123;<span class="hljs-string">'mirror_url'</span>: mirror_url&#125;, mirror_url_item)<br>                new_config = <span class="hljs-string">'%(mirror_url)s\n%(source)s'</span> % &#123;<span class="hljs-string">'mirror_url'</span>: mirror_url_item, <span class="hljs-string">'source'</span>: config&#125;<br>                outfile = codecs.open(path, <span class="hljs-string">'w'</span>, <span class="hljs-string">'utf-8'</span>)<br>                outfile.write(new_config)<br>                outfile.close()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    parser = argparse.ArgumentParser()<br>    parser.add_argument(<span class="hljs-string">"-url"</span>, <span class="hljs-string">"--mirror_url"</span>, help=<span class="hljs-string">"输入其他镜像源"</span>, default=<span class="hljs-string">"https://mirrors.cloud.tencent.com/msys2"</span>)<br>    parser.add_argument(<span class="hljs-string">"-msys2"</span>, <span class="hljs-string">"--msys2_dir"</span>, help=<span class="hljs-string">"msys2安装目录"</span>, default=<span class="hljs-string">"C:/msys64"</span>)<br><br>    args = parser.parse_args()<br><br>    pacman_mirror_dir = <span class="hljs-string">"%s/etc/pacman.d"</span> % (args.msys2_dir)<br>    os.chdir(pacman_mirror_dir)<br>    add_mirror_url(args.mirror_url)<br></code></pre></td></tr></table></figure><br><br></details>

<p>但考虑到后续会推广给不会撸码的童鞋使用这个集成脚本，而这些童鞋大部分都是首次安装msys2的，因此，基于Python实现的脚本显然是不行的，又重新实现了一个bash脚本</p>
<p>由于bash脚本本身对文件、字符串等操作的支持极其有限，在此使用了msys2内置的sed、cp、cat、grep等工具来实现</p>
<p>在编写这个bash脚本的时候，遇到了一些知识盲区，特意记录下来：</p>
<ul>
<li>✔ grep正则查找</li>
<li>✔ sed正则替换需要对双引号、小括号等特殊字符进行前置转义</li>
<li>✔ 在shell函数内修改传参变量的内容</li>
<li>✔ 在文件首行插入新内容</li>
</ul>
<details><br>  <summary>append_extra_mirror_source.sh</summary><br><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash<br></span><br><span class="hljs-comment"># sed 需要对斜杆和括号等字符进行转义后才能正常正则替换</span><br><span class="hljs-function"><span class="hljs-title">replace_escape_string</span></span>()&#123;<br>    <span class="hljs-built_in">eval</span> <span class="hljs-variable">$2</span>=\<span class="hljs-string">"<span class="hljs-variable">$(eval echo "\$&#123;$1&#125;" | sed "s/\//\\\\\//g; s/(/\\\\(/g; s/)</span>/\\\\)/g"</span>)\<span class="hljs-string">"<br>&#125;<br><br># 在文件头上加入其它镜像源<br>push_front_mirror_url()&#123;<br>    _source_config_file=<span class="hljs-variable">$1</span><br>    _backup_config_file=<span class="hljs-variable">$(dirname $1)</span>/bak_<span class="hljs-variable">$(basename $1)</span><br>    _old_mirror_pattern=<span class="hljs-variable">$2</span><br>    _new_mirror_host=<span class="hljs-variable">$3</span><br><br>    # 备份原本的镜像源配置<br>    if [ ! -f <span class="hljs-variable">$&#123;_backup_config_file&#125;</span> ]; then<br>        cp <span class="hljs-variable">$_source_config_file</span> <span class="hljs-variable">$&#123;_backup_config_file&#125;</span><br>    fi<br><br>    # 找到镜像源配置模板<br>    mirror_temp_url=<span class="hljs-variable">$(grep -r -P "$_old_mirror_pattern" $&#123;_backup_config_file&#125;)</span><br><br>    replace_escape_string _old_mirror_pattern _old_mirror_pattern<br>    replace_escape_string _new_mirror_host _new_mirror_host<br><br>    # 根据模板镜像源修改成新的镜像源<br>    new_mirror_url=<span class="hljs-variable">$(echo $mirror_temp_url | sed "s/$_old_mirror_pattern/\\1$_new_mirror_host\\3/g")</span><br><br>    # 在文件头上插入新的镜像源链接<br>    (echo <span class="hljs-variable">$new_mirror_url</span> &amp;&amp; cat <span class="hljs-variable">$&#123;_backup_config_file&#125;</span>) &gt; <span class="hljs-variable">$_source_config_file</span><br>&#125;<br><br>main()&#123;<br>    # 腾讯云镜像源<br>    # new_mirror_host="</span>https://mirrors.cloud.tencent.com/msys2<span class="hljs-string">"<br><br>    # 清华镜像源<br>    new_mirror_host="</span>https://mirrors.tuna.tsinghua.edu.cn/msys2<span class="hljs-string">"<br><br>    old_mirror_pattern="</span>(Server.*)(http.*repo.msys2.org)(.*)<span class="hljs-string">"<br><br>    if [ <span class="hljs-variable">$&#123;#&#125;</span> == 1 ]; then<br>        new_mirror_host=<span class="hljs-variable">$1</span><br>    fi<br><br>    # 遍历pacman的镜像源配置<br>    for file in /etc/pacman.d/mirror*; do<br>        push_front_mirror_url <span class="hljs-variable">$file</span> <span class="hljs-variable">$old_mirror_pattern</span> <span class="hljs-variable">$new_mirror_host</span><br>    done<br>&#125;<br><br>main <span class="hljs-variable">$1</span></span><br></code></pre></td></tr></table></figure><br><br></details>

<h2 id="改造msys2" class="article-heading"><a href="#改造msys2" class="headerlink" title="改造msys2"></a>改造msys2<a class="article-anchor" href="#改造msys2" aria-hidden="true"></a></h2><h3 id="让msys2支持在dos上直接执行shell指令" class="article-heading"><a href="#让msys2支持在dos上直接执行shell指令" class="headerlink" title="让msys2支持在dos上直接执行shell指令"></a>让msys2支持在dos上直接执行shell指令<a class="article-anchor" href="#让msys2支持在dos上直接执行shell指令" aria-hidden="true"></a></h3><p>在着手实现过程中，以下这些点是挺有意思的：</p>
<ul>
<li>✔ 在dos中调用msys2来直接执行shell指令<blockquote>
<p>详情看mintty的参数列表：<code>-c bash_cmd</code></p>
</blockquote>
</li>
<li>✔ 如何指定msys2的启动目录<blockquote>
<p>详情看mintty的参数列表：<code>-where dir</code></p>
</blockquote>
</li>
<li>✔ 在msys2里，将父bash的alias传递给子bash，并且执行其它指令<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">bash --noprofile --rcfile &lt;(<span class="hljs-built_in">alias</span>)<br></code></pre></td></tr></table></figure>
</li>
</ul>
<details><br>  <summary>msys2_shell_ex.cmd</summary><br><br>在msys2_shell.cmd之上增加一个命令行参数支持：<code>-outside_exec COMMAND</code><br><br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br></pre></td><td class="code"><pre><code class="hljs bat">@<span class="hljs-built_in">echo</span> off<br><span class="hljs-built_in">setlocal</span> EnableDelayedExpansion<br><br><span class="hljs-built_in">set</span> "WD=<span class="hljs-variable">%__CD__%</span>"<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXIST</span> "<span class="hljs-variable">%WD%</span>msys-<span class="hljs-number">2</span>.<span class="hljs-number">0</span>.dll" <span class="hljs-built_in">set</span> "WD=%~dp0usr\bin\"<br><span class="hljs-built_in">set</span> "LOGINSHELL=bash"<br><span class="hljs-built_in">set</span> /a msys2_shiftCounter=<span class="hljs-number">0</span><br><span class="hljs-comment"><br>rem To activate windows native symlinks uncomment next line</span><br><span class="hljs-comment">rem set MSYS=winsymlinks:nativestrict</span><br><span class="hljs-comment"><br>rem Set debugging program for errors</span><br><span class="hljs-comment">rem set MSYS=error_start:%WD%../../mingw64/bin/qtcreator.exe^|-debug^|^&lt;process-id^&gt;</span><br><span class="hljs-comment"><br>rem To export full current PATH from environment into MSYS2 use '-use-full-path' parameter</span><br><span class="hljs-comment">rem or uncomment next line</span><br><span class="hljs-comment">rem set MSYS2_PATH_TYPE=inherit</span><br><br>:checkparams<br><span class="hljs-comment">rem Help option</span><br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-<span class="hljs-built_in">help</span>" (<br>  <span class="hljs-keyword">call</span> :printhelp "%~nx0"<br>  <span class="hljs-keyword">exit</span> /b <span class="hljs-variable">%ERRORLEVEL%</span><br>)<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x--<span class="hljs-built_in">help</span>" (<br>  <span class="hljs-keyword">call</span> :printhelp "%~nx0"<br>  <span class="hljs-keyword">exit</span> /b <span class="hljs-variable">%ERRORLEVEL%</span><br>)<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-?" (<br>  <span class="hljs-keyword">call</span> :printhelp "%~nx0"<br>  <span class="hljs-keyword">exit</span> /b <span class="hljs-variable">%ERRORLEVEL%</span><br>)<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x/?" (<br>  <span class="hljs-keyword">call</span> :printhelp "%~nx0"<br>  <span class="hljs-keyword">exit</span> /b <span class="hljs-variable">%ERRORLEVEL%</span><br>)<br><span class="hljs-comment">rem Shell types</span><br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-msys" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSTEM=MSYS&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-msys2" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSTEM=MSYS&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-mingw32" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSTEM=MINGW32&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-mingw64" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSTEM=MINGW64&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-ucrt64" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSTEM=UCRT64&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-clang64" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSTEM=CLANG64&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-mingw" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; (<span class="hljs-keyword">if</span> <span class="hljs-keyword">exist</span> "<span class="hljs-variable">%WD%</span>..\..\mingw64" (<span class="hljs-built_in">set</span> MSYSTEM=MINGW64) <span class="hljs-keyword">else</span> (<span class="hljs-built_in">set</span> MSYSTEM=MINGW32))&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-comment">rem Console types</span><br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-mintty" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSCON=mintty.exe&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-conemu" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSCON=conemu&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-defterm" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYSCON=defterm&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-comment">rem Other parameters</span><br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-full-<span class="hljs-built_in">path</span>" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYS2_PATH_TYPE=inherit&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-use-full-<span class="hljs-built_in">path</span>" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYS2_PATH_TYPE=inherit&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-here" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> CHERE_INVOKING=enabled_from_arguments&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-where" (<br>  <span class="hljs-keyword">if</span> "x%~<span class="hljs-number">2</span>" == "x" (<br>    <span class="hljs-built_in">echo</span> Working directory is <span class="hljs-keyword">not</span> specified <span class="hljs-keyword">for</span> -where parameter. <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">2</span><br>    <span class="hljs-keyword">exit</span> /b <span class="hljs-number">2</span><br>  )<br>  <span class="hljs-built_in">cd</span> /d "%~<span class="hljs-number">2</span>" || (<br>    <span class="hljs-built_in">echo</span> Cannot <span class="hljs-built_in">set</span> specified working diretory "%~<span class="hljs-number">2</span>". <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">2</span><br>    <span class="hljs-keyword">exit</span> /b <span class="hljs-number">2</span><br>  )<br>  <span class="hljs-built_in">set</span> CHERE_INVOKING=enabled_from_arguments<br><span class="hljs-comment"><br>  rem Ensure parentheses in argument do not interfere with FOR IN loop below.</span><br>  <span class="hljs-built_in">set</span> msys2_arg="%~<span class="hljs-number">2</span>"<br>  <span class="hljs-keyword">call</span> :substituteparens msys2_arg<br>  <span class="hljs-keyword">call</span> :removequotes msys2_arg<br><span class="hljs-comment"><br>  rem Increment msys2_shiftCounter by number of words in argument (as cmd.exe saw it).</span><br><span class="hljs-comment">  rem (Note that this form of FOR IN loop uses same delimiters as parameters.)</span><br>  <span class="hljs-keyword">for</span> <span class="hljs-variable">%%a</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">!msys2_arg!</span>) <span class="hljs-keyword">do</span> <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span><br>)&amp; <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-no-<span class="hljs-built_in">start</span>" <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-built_in">set</span> MSYS2_NOSTART=yes&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-shell" (<br>  <span class="hljs-keyword">if</span> "x%~<span class="hljs-number">2</span>" == "x" (<br>    <span class="hljs-built_in">echo</span> Shell <span class="hljs-keyword">not</span> specified <span class="hljs-keyword">for</span> -shell parameter. <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">2</span><br>    <span class="hljs-keyword">exit</span> /b <span class="hljs-number">2</span><br>  )<br>  <span class="hljs-built_in">set</span> LOGINSHELL="%~<span class="hljs-number">2</span>"<br>  <span class="hljs-keyword">call</span> :removequotes LOGINSHELL<br>  <br>  <span class="hljs-built_in">set</span> msys2_arg="%~<span class="hljs-number">2</span>"<br>  <span class="hljs-keyword">call</span> :substituteparens msys2_arg<br>  <span class="hljs-keyword">call</span> :removequotes msys2_arg<br>  <span class="hljs-keyword">for</span> <span class="hljs-variable">%%a</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">!msys2_arg!</span>) <span class="hljs-keyword">do</span> <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span><br>)&amp; <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-keyword">if</span> "x%~<span class="hljs-number">1</span>" == "x-outside_exec" (<br>  <span class="hljs-keyword">if</span> "x%~<span class="hljs-number">2</span>" == "x" (<br>    <span class="hljs-built_in">echo</span> Please input bash shell command <span class="hljs-keyword">for</span> -outside_exec parameter. <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">2</span><br>    <span class="hljs-keyword">exit</span> /b <span class="hljs-number">2</span><br>  )<br><br>  <span class="hljs-built_in">set</span> OUTSIDE_CMD="%~<span class="hljs-number">2</span>"<br><span class="hljs-comment">  @REM call :substituteparens OUTSIDE_CMD</span><br><span class="hljs-comment">  @REM call :removequotes OUTSIDE_CMD</span><br><br>  <span class="hljs-built_in">set</span> msys2_arg="%~<span class="hljs-number">2</span>"<br>  <span class="hljs-keyword">call</span> :substituteparens msys2_arg<br>  <span class="hljs-keyword">call</span> :removequotes msys2_arg<br><span class="hljs-comment"><br>  rem Increment msys2_shiftCounter by number of words in argument (as cmd.exe saw it).</span><br><span class="hljs-comment">  rem (Note that this form of FOR IN loop uses same delimiters as parameters.)</span><br>  <span class="hljs-keyword">for</span> <span class="hljs-variable">%%a</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">!msys2_arg!</span>) <span class="hljs-keyword">do</span> <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span><br>)&amp; <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">shift</span>&amp; <span class="hljs-built_in">set</span> /a msys2_shiftCounter+=<span class="hljs-number">1</span>&amp; <span class="hljs-keyword">goto</span> :checkparams<br><span class="hljs-comment"><br>rem Collect remaining command line arguments to be passed to shell</span><br><span class="hljs-keyword">if</span> <span class="hljs-variable">%msys2_shiftCounter%</span> <span class="hljs-keyword">equ</span> <span class="hljs-number">0</span> <span class="hljs-built_in">set</span> SHELL_ARGS=%* &amp; <span class="hljs-keyword">goto</span> cleanvars<br><span class="hljs-built_in">set</span> msys2_full_cmd=%*<br><span class="hljs-keyword">for</span> /f "tokens=<span class="hljs-variable">%msys2_shiftCounter%</span>,* delims=,;=	 " <span class="hljs-variable">%%i</span> <span class="hljs-keyword">in</span> ("<span class="hljs-variable">!msys2_full_cmd!</span>") <span class="hljs-keyword">do</span> <span class="hljs-built_in">set</span> SHELL_ARGS=<span class="hljs-variable">%%j</span><br><br>:cleanvars<br><span class="hljs-built_in">set</span> msys2_arg=<br><span class="hljs-built_in">set</span> msys2_shiftCounter=<br><span class="hljs-built_in">set</span> msys2_full_cmd=<br><span class="hljs-comment"><br>rem Setup proper title and icon</span><br><span class="hljs-keyword">if</span> "<span class="hljs-variable">%MSYSTEM%</span>" == "MINGW32" (<br>  <span class="hljs-built_in">set</span> "CONTITLE=MinGW x32"<br>  <span class="hljs-built_in">set</span> "CONICON=mingw32.ico"<br>) <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> "<span class="hljs-variable">%MSYSTEM%</span>" == "MINGW64" (<br>  <span class="hljs-built_in">set</span> "CONTITLE=MinGW x64"<br>  <span class="hljs-built_in">set</span> "CONICON=mingw64.ico"<br>) <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> "<span class="hljs-variable">%MSYSTEM%</span>" == "UCRT64" (<br>  <span class="hljs-built_in">set</span> "CONTITLE=MinGW UCRT x64"<br>  <span class="hljs-built_in">set</span> "CONICON=ucrt64.ico"<br>) <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> "<span class="hljs-variable">%MSYSTEM%</span>" == "CLANG64" (<br>  <span class="hljs-built_in">set</span> "CONTITLE=MinGW Clang x64"<br>  <span class="hljs-built_in">set</span> "CONICON=clang64.ico"<br>) <span class="hljs-keyword">else</span> (<br>  <span class="hljs-built_in">set</span> "CONTITLE=MSYS2 MSYS"<br>  <span class="hljs-built_in">set</span> "CONICON=msys2.ico"<br>)<br><br><span class="hljs-keyword">if</span> "x<span class="hljs-variable">%MSYSCON%</span>" == "xmintty.exe" <span class="hljs-keyword">goto</span> startmintty<br><span class="hljs-keyword">if</span> "x<span class="hljs-variable">%MSYSCON%</span>" == "xconemu" <span class="hljs-keyword">goto</span> startconemu<br><span class="hljs-keyword">if</span> "x<span class="hljs-variable">%MSYSCON%</span>" == "xdefterm" <span class="hljs-keyword">goto</span> startsh<br><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXIST</span> "<span class="hljs-variable">%WD%</span>mintty.exe" <span class="hljs-keyword">goto</span> startsh<br><span class="hljs-built_in">set</span> MSYSCON=mintty.exe<br>:startmintty<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> MSYS2_NOSTART (<br>  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> OUTSIDE_CMD (<br>    <span class="hljs-built_in">start</span> "<span class="hljs-variable">%CONTITLE%</span>" "<span class="hljs-variable">%WD%</span>mintty" -i "/<span class="hljs-variable">%CONICON%</span>" -t "<span class="hljs-variable">%CONTITLE%</span>" "/usr/bin/<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span><br>  ) <span class="hljs-keyword">else</span> (<br>    <span class="hljs-built_in">start</span> "<span class="hljs-variable">%CONTITLE%</span>" "<span class="hljs-variable">%WD%</span>mintty" -i "/<span class="hljs-variable">%CONICON%</span>" -t "<span class="hljs-variable">%CONTITLE%</span>" "/usr/bin/<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span> -c <span class="hljs-variable">%OUTSIDE_CMD%</span><br>  )<br>) <span class="hljs-keyword">else</span> (<br>  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> OUTSIDE_CMD (<br>    "<span class="hljs-variable">%WD%</span>mintty" -i "/<span class="hljs-variable">%CONICON%</span>" -t "<span class="hljs-variable">%CONTITLE%</span>" "/usr/bin/<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span><br>  ) <span class="hljs-keyword">else</span> (<br>    "<span class="hljs-variable">%WD%</span>mintty" -i "/<span class="hljs-variable">%CONICON%</span>" -t "<span class="hljs-variable">%CONTITLE%</span>" "/usr/bin/<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span> -c <span class="hljs-variable">%OUTSIDE_CMD%</span><br>  )<br>)<br><span class="hljs-keyword">exit</span> /b <span class="hljs-variable">%ERRORLEVEL%</span><br><br>:startconemu<br><span class="hljs-keyword">call</span> :conemudetect || (<br>  <span class="hljs-built_in">echo</span> ConEmu <span class="hljs-keyword">not</span> found. Exiting. <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">2</span><br>  <span class="hljs-keyword">exit</span> /b <span class="hljs-number">1</span><br>)<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> MSYS2_NOSTART (<br>  <span class="hljs-built_in">start</span> "<span class="hljs-variable">%CONTITLE%</span>" "<span class="hljs-variable">%ComEmuCommand%</span>" /Here /Icon "<span class="hljs-variable">%WD%</span>..\..\<span class="hljs-variable">%CONICON%</span>" /<span class="hljs-built_in">cmd</span> "<span class="hljs-variable">%WD%</span>\<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span><br>) <span class="hljs-keyword">else</span> (<br>  "<span class="hljs-variable">%ComEmuCommand%</span>" /Here /Icon "<span class="hljs-variable">%WD%</span>..\..\<span class="hljs-variable">%CONICON%</span>" /<span class="hljs-built_in">cmd</span> "<span class="hljs-variable">%WD%</span>\<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span><br>)<br><span class="hljs-keyword">exit</span> /b <span class="hljs-variable">%ERRORLEVEL%</span><br><br>:startsh<br><span class="hljs-built_in">set</span> MSYSCON=<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> MSYS2_NOSTART (<br>  <span class="hljs-built_in">start</span> "<span class="hljs-variable">%CONTITLE%</span>" "<span class="hljs-variable">%WD%</span>\<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span><br>) <span class="hljs-keyword">else</span> (<br>  "<span class="hljs-variable">%WD%</span>\<span class="hljs-variable">%LOGINSHELL%</span>" --login <span class="hljs-variable">!SHELL_ARGS!</span><br>)<br><span class="hljs-keyword">exit</span> /b <span class="hljs-variable">%ERRORLEVEL%</span><br><br>:EOF<br><span class="hljs-keyword">exit</span> /b <span class="hljs-number">0</span><br><br>:conemudetect<br><span class="hljs-built_in">set</span> ComEmuCommand=<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">defined</span> ConEmuDir (<br>  <span class="hljs-keyword">if</span> <span class="hljs-keyword">exist</span> "<span class="hljs-variable">%ConEmuDir%</span>\ConEmu64.exe" (<br>    <span class="hljs-built_in">set</span> "ComEmuCommand=<span class="hljs-variable">%ConEmuDir%</span>\ConEmu64.exe"<br>    <span class="hljs-built_in">set</span> MSYSCON=conemu64.exe<br>  ) <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">exist</span> "<span class="hljs-variable">%ConEmuDir%</span>\ConEmu.exe" (<br>    <span class="hljs-built_in">set</span> "ComEmuCommand=<span class="hljs-variable">%ConEmuDir%</span>\ConEmu.exe"<br>    <span class="hljs-built_in">set</span> MSYSCON=conemu.exe<br>  )<br>)<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> ComEmuCommand (<br>  ConEmu64.exe /<span class="hljs-keyword">Exit</span> <span class="hljs-number">2</span>&gt;<span class="hljs-built_in">nul</span> &amp;&amp; (<br>    <span class="hljs-built_in">set</span> ComEmuCommand=ConEmu64.exe<br>    <span class="hljs-built_in">set</span> MSYSCON=conemu64.exe<br>  ) || (<br>    ConEmu.exe /<span class="hljs-keyword">Exit</span> <span class="hljs-number">2</span>&gt;<span class="hljs-built_in">nul</span> &amp;&amp; (<br>      <span class="hljs-built_in">set</span> ComEmuCommand=ConEmu.exe<br>      <span class="hljs-built_in">set</span> MSYSCON=conemu.exe<br>    )<br>  )<br>)<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> ComEmuCommand (<br>  <span class="hljs-keyword">FOR</span> /F "tokens=*" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('reg.exe QUERY "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\ConEmu64.exe" /ve <span class="hljs-number">2</span>^&gt;<span class="hljs-built_in">nul</span> ^| <span class="hljs-built_in">find</span> "REG_SZ"') <span class="hljs-keyword">DO</span> (<br>    <span class="hljs-built_in">set</span> "ComEmuCommand=<span class="hljs-variable">%%A</span>"<br>  )<br>  <span class="hljs-keyword">if</span> <span class="hljs-keyword">defined</span> ComEmuCommand (<br>    <span class="hljs-keyword">call</span> <span class="hljs-built_in">set</span> "ComEmuCommand=<span class="hljs-variable">%%C</span>omEmuCommand:*REG_SZ    =<span class="hljs-variable">%%"</span><br>    <span class="hljs-built_in">set</span> MSYSCON=conemu64.exe<br>  ) <span class="hljs-keyword">else</span> (<br>    <span class="hljs-keyword">FOR</span> /F "tokens=*" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('reg.exe QUERY "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\ConEmu.exe" /ve <span class="hljs-number">2</span>^&gt;<span class="hljs-built_in">nul</span> ^| <span class="hljs-built_in">find</span> "REG_SZ"') <span class="hljs-keyword">DO</span> (<br>      <span class="hljs-built_in">set</span> "ComEmuCommand=<span class="hljs-variable">%%A</span>"<br>    )<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">defined</span> ComEmuCommand (<br>      <span class="hljs-keyword">call</span> <span class="hljs-built_in">set</span> "ComEmuCommand=<span class="hljs-variable">%%C</span>omEmuCommand:*REG_SZ    =<span class="hljs-variable">%%"</span><br>      <span class="hljs-built_in">set</span> MSYSCON=conemu.exe<br>    )<br>  )<br>)<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> ComEmuCommand <span class="hljs-keyword">exit</span> /b <span class="hljs-number">2</span><br><span class="hljs-keyword">exit</span> /b <span class="hljs-number">0</span><br><br>:printhelp<br><span class="hljs-built_in">echo</span> Usage:<br><span class="hljs-built_in">echo</span>     %~<span class="hljs-number">1</span> [options] [login shell parameters]<br><span class="hljs-built_in">echo</span>.<br><span class="hljs-built_in">echo</span> Options:<br><span class="hljs-built_in">echo</span>     -mingw32 ^| -mingw64 ^| -ucrt64 ^| -clang64 ^| -msys[<span class="hljs-number">2</span>]   <span class="hljs-built_in">Set</span> shell <span class="hljs-built_in">type</span><br><span class="hljs-built_in">echo</span>     -defterm ^| -mintty ^| -conemu                            <span class="hljs-built_in">Set</span> terminal <span class="hljs-built_in">type</span><br><span class="hljs-built_in">echo</span>     -here                            Use current directory as working<br><span class="hljs-built_in">echo</span>                                      directory<br><span class="hljs-built_in">echo</span>     -where DIRECTORY                 Use specified DIRECTORY as working<br><span class="hljs-built_in">echo</span>                                      directory<br><span class="hljs-built_in">echo</span>     -outside_exec COMMAND            Input Outside Bash-Command<br><span class="hljs-built_in">echo</span>     -[use-]full-<span class="hljs-built_in">path</span>                 Use full current <span class="hljs-built_in">PATH</span> variable<br><span class="hljs-built_in">echo</span>                                      instead of trimming to minimal<br><span class="hljs-built_in">echo</span>     -no-<span class="hljs-built_in">start</span>                        <span class="hljs-keyword">Do</span> <span class="hljs-keyword">not</span> use "<span class="hljs-built_in">start</span>" command and<br><span class="hljs-built_in">echo</span>                                      return login shell resulting <br><span class="hljs-built_in">echo</span>                                      errorcode as this batch file <br><span class="hljs-built_in">echo</span>                                      resulting errorcode<br><span class="hljs-built_in">echo</span>     -shell SHELL                     <span class="hljs-built_in">Set</span> login shell<br><span class="hljs-built_in">echo</span>     -<span class="hljs-built_in">help</span> ^| --<span class="hljs-built_in">help</span> ^| -? ^| /?         Display this <span class="hljs-built_in">help</span> and <span class="hljs-keyword">exit</span><br><span class="hljs-built_in">echo</span>.<br><span class="hljs-built_in">echo</span> Any parameter that cannot be treated as valid option and all<br><span class="hljs-built_in">echo</span> following parameters are passed as login shell command parameters.<br><span class="hljs-built_in">echo</span>.<br><span class="hljs-keyword">exit</span> /b <span class="hljs-number">0</span><br><br>:removequotes<br><span class="hljs-keyword">FOR</span> /F "delims=" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%%</span><span class="hljs-number">1</span><span class="hljs-variable">%%'</span>) <span class="hljs-keyword">DO</span> <span class="hljs-built_in">set</span> <span class="hljs-variable">%1=%</span>%~A<br><span class="hljs-keyword">GOTO</span> :eof<br><br>:substituteparens<br><span class="hljs-built_in">SETLOCAL</span><br><span class="hljs-keyword">FOR</span> /F "delims=" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%%</span><span class="hljs-number">1</span><span class="hljs-variable">%%'</span>) <span class="hljs-keyword">DO</span> (<br>    <span class="hljs-built_in">set</span> value=<span class="hljs-variable">%%A</span><br>    <span class="hljs-built_in">set</span> value=<span class="hljs-variable">!value:^(=x!</span><br>    <span class="hljs-built_in">set</span> value=<span class="hljs-variable">!value:^)=x!</span><br>)<br><span class="hljs-built_in">ENDLOCAL</span> &amp; <span class="hljs-built_in">set</span> <span class="hljs-variable">%1=%</span>value%<br><span class="hljs-keyword">GOTO</span> :eof<br></code></pre></td></tr></table></figure><br><br></details>

<h3 id="将msys2添加到右键菜单上" class="article-heading"><a href="#将msys2添加到右键菜单上" class="headerlink" title="将msys2添加到右键菜单上"></a>将msys2添加到右键菜单上<a class="article-anchor" href="#将msys2添加到右键菜单上" aria-hidden="true"></a></h3><ul>
<li>✔ 在目录下或者文件夹上执行该菜单命令时，启动msys2并定位到该目录下</li>
<li>✔ 在某个文件上执行该菜单命令时，启动msys2，定位到该文件所在目录，并用Vim打开该文件</li>
</ul>
<details><br>  <summary>msys2_vim_installer.bat</summary><br><br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bat">@<span class="hljs-built_in">echo</span> off<br>::判断是否已经获取了管理员身份<br><span class="hljs-built_in">Md</span> "<span class="hljs-variable">%WinDir%</span>\System32\test_permissions" <span class="hljs-number">2</span>&gt;<span class="hljs-built_in">NUL</span>||(<span class="hljs-built_in">Echo</span> 请使用右键管理员身份运行&amp;&amp;<span class="hljs-built_in">Pause</span> &gt;<span class="hljs-built_in">NUL</span>&amp;&amp;<span class="hljs-keyword">Exit</span>)<br><span class="hljs-built_in">Rd</span> "<span class="hljs-variable">%WinDir%</span>\System32\test_permissions" <span class="hljs-number">2</span>&gt;<span class="hljs-built_in">NUL</span><br><span class="hljs-built_in">SetLocal</span> EnableDelayedExpansion<br><br><span class="hljs-keyword">call</span> %~dp0create_depends_env.bat<br><br>::设置右键菜单项的名称<br><span class="hljs-built_in">set</span> desc="Msys2-Vim"<br>::设置搭建编译环境的BAT<br><span class="hljs-built_in">set</span> runbat="run_msys2_vim.bat"<br>::设置子路径名称<br><span class="hljs-built_in">set</span> subname="msys2_vim"<br>::去掉双引号，主要是为了兼容包含了空格的文件名或路径<br><span class="hljs-keyword">call</span> :removequotes runbat<br><span class="hljs-keyword">call</span> :removequotes subname<br><br>::添加注册表信息<br>reg add "HKEY_CLASSES_ROOT\Directory\background\shell\<span class="hljs-variable">%subname%</span>" /v "" /t REG_SZ /d <span class="hljs-variable">%desc%</span><br>reg add "HKEY_CLASSES_ROOT\Directory\background\shell\<span class="hljs-variable">%subname%</span>\command" /v ""  /t REG_EXPAND_SZ /d "\"<span class="hljs-variable">%~dp0%</span>runbat%\" \"<span class="hljs-variable">%%V</span>\"<br><br>reg add "HKEY_CURRENT_USER\Software\Classes\*\shell\<span class="hljs-variable">%subname%</span>" /v "" /t REG_SZ /d <span class="hljs-variable">%desc%</span><br>reg add "HKEY_CURRENT_USER\Software\Classes\*\shell\<span class="hljs-variable">%subname%</span>\command" /v "" /t REG_EXPAND_SZ /d "\"<span class="hljs-variable">%~dp0%</span>runbat%\" \"<span class="hljs-variable">%%V</span>\"<br><br>reg add "HKEY_CLASSES_ROOT\Directory\shell\<span class="hljs-variable">%subname%</span>" /v "" /t REG_SZ /d <span class="hljs-variable">%desc%</span><br>reg add "HKEY_CLASSES_ROOT\Directory\shell\<span class="hljs-variable">%subname%</span>\command" /v "" /t REG_EXPAND_SZ /d "\"<span class="hljs-variable">%~dp0%</span>runbat%\" \"<span class="hljs-variable">%%V</span>\"<br><br>:removequotes<br><span class="hljs-keyword">FOR</span> /F "delims=" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%%</span><span class="hljs-number">1</span><span class="hljs-variable">%%'</span>) <span class="hljs-keyword">DO</span> <span class="hljs-built_in">set</span> <span class="hljs-variable">%1=%</span>%~A<br><span class="hljs-keyword">GOTO</span> :eof<br></code></pre></td></tr></table></figure><br><br></details>

<details><br>  <summary>run_msys2_vim.bat</summary><br><br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bat">@<span class="hljs-built_in">echo</span> off<br><br><span class="hljs-keyword">call</span> %~dp0config.bat<br><br><span class="hljs-built_in">set</span> ROOT=%<span class="hljs-number">1</span><br><span class="hljs-keyword">call</span> :removequotes ROOT<br><br><span class="hljs-built_in">pushd</span> "<span class="hljs-variable">%ROOT%</span>" <span class="hljs-number">2</span>&gt;<span class="hljs-built_in">nul</span> &amp;&amp; (<span class="hljs-keyword">call</span> :folder "<span class="hljs-variable">%ROOT%</span>" &amp; <span class="hljs-built_in">popd</span>) || <span class="hljs-keyword">call</span> :file "<span class="hljs-variable">%ROOT%</span>"<br><span class="hljs-keyword">GOTO</span> :eof<br><br>:file<br><span class="hljs-keyword">call</span> :filename ROOT file_name<br><span class="hljs-keyword">call</span> :dirname ROOT dir_name<br><br><span class="hljs-built_in">set</span> command_args=<span class="hljs-variable">%msys2_type%</span> -where "<span class="hljs-variable">%dir_name%</span>"<br><span class="hljs-keyword">call</span> <span class="hljs-variable">%msys2_shell_bat%</span> <span class="hljs-variable">%command_args%</span> -outside_exec "vim '<span class="hljs-variable">%file_name%</span>'"<br><span class="hljs-keyword">GOTO</span> :eof<br><br>:folder<br><span class="hljs-built_in">set</span> command_args=<span class="hljs-variable">%msys2_type%</span> -where "<span class="hljs-variable">%ROOT%</span>"<br><span class="hljs-keyword">call</span> <span class="hljs-variable">%msys2_shell_bat%</span> <span class="hljs-variable">%command_args%</span><br><span class="hljs-keyword">GOTO</span> :eof<br><br>:removequotes<br><span class="hljs-keyword">FOR</span> /F "delims=" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%%</span><span class="hljs-number">1</span><span class="hljs-variable">%%'</span>) <span class="hljs-keyword">DO</span> <span class="hljs-built_in">set</span> <span class="hljs-variable">%1=%</span>%~A<br><span class="hljs-keyword">GOTO</span> :eof<br><br>:dirname<br><span class="hljs-keyword">FOR</span> /F "delims=" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%%</span><span class="hljs-number">1</span><span class="hljs-variable">%%'</span>) <span class="hljs-keyword">DO</span> <span class="hljs-built_in">set</span> <span class="hljs-variable">%2=%</span>%~dpA<br><span class="hljs-keyword">GOTO</span> :eof<br><br>:filename<br><span class="hljs-keyword">FOR</span> /F "delims=" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%%</span><span class="hljs-number">1</span><span class="hljs-variable">%%'</span>) <span class="hljs-keyword">DO</span> <span class="hljs-built_in">set</span> <span class="hljs-variable">%2=%</span>%~nxA<br><span class="hljs-keyword">GOTO</span> :eof<br></code></pre></td></tr></table></figure><br><br></details>

<p>由于本人希望，尽量少得对msys2安装目录进行修改，所以，另外提供一个脚本来关联msys2和当前脚本的关系</p>
<details><br>  <summary>create_depends_env.bat</summary><br><br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bat">@<span class="hljs-built_in">echo</span> off<br><span class="hljs-comment">REM 创建目录关联</span><br><br><span class="hljs-built_in">echo</span> 将msys2目录粘贴到这里<br><span class="hljs-built_in">set</span> /p msys2_dir=<br><br><span class="hljs-keyword">call</span> :removequotes msys2_dir<br><br><span class="hljs-built_in">set</span> msys2_shell_ex_bat=%~dp0msys2_shell_ex.<span class="hljs-built_in">cmd</span><br><span class="hljs-built_in">set</span> dest_path="<span class="hljs-variable">%msys2_dir%</span>\msys2_shell_ex.<span class="hljs-built_in">cmd</span>"<br><span class="hljs-comment"><br>@REM 自动生成config.bat</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">exist</span> "%~dp0config.bat" (<br>    <span class="hljs-built_in">echo</span> @<span class="hljs-built_in">echo</span> off&gt;&gt; %~dp0config.bat<br>    <span class="hljs-built_in">echo</span> <span class="hljs-built_in">set</span> msys2_shell_bat="<span class="hljs-variable">%msys2_dir%</span>\msys2_shell_ex.<span class="hljs-built_in">cmd</span>"&gt;&gt; %~dp0config.bat<br>    <span class="hljs-built_in">echo</span> <span class="hljs-built_in">set</span> msys2_type=-mingw64&gt;&gt; %~dp0config.bat<br>    <span class="hljs-built_in">echo</span> <span class="hljs-built_in">set</span> pause_cmd=read -p 'Please press any key after'&gt;&gt; %~dp0config.bat<br>)<br><span class="hljs-comment"><br>REM 创建msys2_shell_ex.cmd文件链接</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">exist</span> <span class="hljs-variable">%dest_path%</span> (mklink <span class="hljs-variable">%dest_path%</span> <span class="hljs-variable">%msys2_shell_ex_bat%</span>)<br><br>:removequotes<br><span class="hljs-keyword">FOR</span> /F "delims=" <span class="hljs-variable">%%A</span> <span class="hljs-keyword">IN</span> ('<span class="hljs-built_in">echo</span> <span class="hljs-variable">%%%</span><span class="hljs-number">1</span><span class="hljs-variable">%%'</span>) <span class="hljs-keyword">DO</span> <span class="hljs-built_in">set</span> <span class="hljs-variable">%1=%</span>%~A<br><span class="hljs-keyword">GOTO</span> :eof<br><br><span class="hljs-keyword">GOTO</span> :eof<br></code></pre></td></tr></table></figure><br><br></details>

<p>最终成品：<a href="/assets/2021-06-14/msys2_vim.zip">msys2_vim.zip</a></p>
<h2 id="参考资料" class="article-heading"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料<a class="article-anchor" href="#参考资料" aria-hidden="true"></a></h2><ul>
<li><a href="https://mirrors.tuna.tsinghua.edu.cn/help/msys2/" target="_blank" rel="noopener">MSYS2 镜像使用帮助</a></li>
<li><a href="/_posts/the_difference_between_msys2_and_cmder.html">msys2和cmder的异同</a></li>
<li><a href="https://unix.stackexchange.com/questions/285009/forward-aliases-to-child-process" target="_blank" rel="noopener">forward aliases to child process</a></li>
<li><a href="https://stackoverflow.com/questions/2752974/invoking-msys-bash-from-windows-cmd" target="_blank" rel="noopener">invoking-msys-bash-from-windows-cmd</a></li>
<li><a href="https://stackoverflow.com/questions/2546757/executing-msys-from-cmd-exe-with-arguments" target="_blank" rel="noopener">executing-msys-from-cmd-exe-with-arguments</a></li>
<li><a href="https://stackoverflow.com/questions/45836650/how-do-i-integrate-msys2-shell-into-visual-studio-code-on-window/48016561#48016561" target="_blank" rel="noopener">how-do-i-integrate-msys2-shell-into-visual-studio-code-on-window</a></li>
</ul>

  </div>
  
</article>

        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2021/03/15/a-way-of-html-encryption/">
              <strong class="archive-post-title" itemprop="name">谈一种页面加密技术</strong>
              <span class="archive-post-date"><time datetime="2021-03-15T00:00:00.000Z">2021-03-15</time></span>
            </a>
          </article>
        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2019/09/10/simplifying-life/">
              <strong class="archive-post-title" itemprop="name">我的断舍离实践</strong>
              <span class="archive-post-date"><time datetime="2019-09-10T00:00:00.000Z">2019-09-10</time></span>
            </a>
          </article>
        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2019/07/24/usage-habits-of-different-operating-systems/">
              <strong class="archive-post-title" itemprop="name">不同操作系统的使用习惯备忘录</strong>
              <span class="archive-post-date"><time datetime="2019-07-24T00:00:00.000Z">2019-07-24</time></span>
            </a>
          </article>
        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2019/07/20/my-music-play-list/">
              <strong class="archive-post-title" itemprop="name">我的音乐清单</strong>
              <span class="archive-post-date"><time datetime="2019-07-20T00:00:00.000Z">2019-07-20</time></span>
            </a>
          </article>
        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2019/06/08/custom-protable-software-base-on-autohotkey/">
              <strong class="archive-post-title" itemprop="name">基于AutoHotKey整合自己的常用软件</strong>
              <span class="archive-post-date"><time datetime="2019-06-08T00:00:00.000Z">2019-06-08</time></span>
            </a>
          </article>
        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2019/05/10/VIM-mode-of-common-tools/">
              <strong class="archive-post-title" itemprop="name">一个伪Vim党的习惯养成</strong>
              <span class="archive-post-date"><time datetime="2019-05-10T00:00:00.000Z">2019-05-10</time></span>
            </a>
          </article>
        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2019/05/07/about-deploy-win10-environment/">
              <strong class="archive-post-title" itemprop="name">谈谈Win10系统的折腾</strong>
              <span class="archive-post-date"><time datetime="2019-05-07T00:00:00.000Z">2019-05-07</time></span>
            </a>
          </article>
        
      
        
          <article class="article post archive-post" itemscope itemtype="http://schema.org/Article">
            <a class="archive-post-link" href="/news/2018/06/23/the-difference-between-msys2-and-cmder/">
              <strong class="archive-post-title" itemprop="name">msys2和cmder的异同</strong>
              <span class="archive-post-date"><time datetime="2018-06-23T00:00:00.000Z">2018-06-23</time></span>
            </a>
          </article>
        
      
    </div>
  </div>
</div>
    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2021 <a href="https://github.com/hexojs/hexo/graphs/contributors" target="_blank">Hexo</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      <a href="https://twitter.com/" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a>
      <a href="https://github.com/" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/news/" class="mobile-nav-link">随笔</a><a href="/dev/" class="mobile-nav-link">开发</a><a href="/open_source/" class="mobile-nav-link">开源</a><a href="/tool/" class="mobile-nav-link">工具</a><a href="/about/" class="mobile-nav-link">关于我</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="zh-cn" selected>简体中文</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<!-- endbuild -->

<!-- Algolia --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>
</html>